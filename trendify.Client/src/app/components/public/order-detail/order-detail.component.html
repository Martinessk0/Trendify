<!-- order-details.component.html -->

<!-- Order exists -->
<div class="container my-4" *ngIf="order">
  <div class="mb-4">
    <a routerLink="/orders" class="text-decoration-none">
      <i class="bi bi-arrow-left-circle me-1"></i> All orders
    </a>
  </div>

  <!-- Order summary + Delivery address side-by-side on md+ -->
  <div class="row row-cols-1 row-cols-md-2 g-4 mb-4">
    <!-- Order summary -->
    <div class="col">
      <div class="card h-100 border-1 rounded-4">
        <div class="card-header">
          <h4 class="mb-0">Order #{{ order.orderNumber }}</h4>
        </div>
        <div class="card-body">
          <div class="row gy-3">
            <div class="col-12 col-sm-4">
              <p class="mb-1"><strong>Date:</strong></p>
              <p class="mb-0">{{ order.orderDate | date:"dd.MM.yyyy HH:mm" }}</p>
            </div>
            <div class="col-12 col-sm-4">
              <p class="mb-1"><strong>Status:</strong></p>
              <span
                class="badge"
                [ngClass]="{
                  'bg-info': order.status==='Pending',
                  'bg-success': order.status==='Completed',
                  'bg-warning text-dark': order.status==='In Progress',
                  'bg-danger': order.status==='Cancelled'
                }"
              >
                {{ order.status }}
              </span>
            </div>
            <div class="col-12 col-sm-4 text-sm-end">
              <p class="mb-1"><strong>Total:</strong></p>
              <h5 class="mb-0">{{ order.total | currency:'BGN':'symbol':'1.2-2' }}</h5>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Delivery address -->
    <div class="col">
      <div class="card h-100 border-1 rounded-4">
        <div class="card-header">
          <h5 class="mb-0"><i class="bi bi-geo-alt me-2"></i> Delivery address</h5>
        </div>
        <div class="card-body">
          <p class="mb-1">{{ order.address.name }}</p>
          <p class="mb-1">{{ order.address.streetAddress }}</p>
          <p class="mb-1">{{ order.address.zipCode }} {{ order.address.city }}</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Divider + Heading -->
  <hr class="my-4">
  <h5 class="mb-3">Order items</h5>

  <!-- Items grid: 1-col on xs, 2-cols on md+ -->
  <div class="row row-cols-1 row-cols-md-2 align-items-stretch">
    <ng-container *ngFor="let item of order.items">
      <div class="col mb-5">
        <app-order-detail-card [item]="item"></app-order-detail-card>
      </div>
    </ng-container>
  </div>
</div>

<!-- Loading state -->
<div class="container my-5 text-center" *ngIf="loading">
  <div class="spinner-border" role="status">
    <span class="visually-hidden">Loading...</span>
  </div>
</div>

<!-- Error state -->
<div class="container my-5" *ngIf="error">
  <div class="alert alert-danger">{{ error }}</div>
</div>
